language: python

matrix:
  include:
    - os: linux
      dist: xenial
      sudo: false
      python: '3.6'
    - os: linux
      dist: xenial
      sudo: false
      python: '3.7'

env: UPLOAD_COV=true
install:
  - make ci_install

script:
  - make lint
  - if [[ $UPLOAD_COV == 'true' ]]; then make cov; else make test; fi

before_deploy:
  - make docs

deploy:
  provider: pages
  skip_cleanup: true
  github-token: $GITHUB_TOKEN
  keep-history: true
  local-dir: docs/_build/html
  on:
    branch: master